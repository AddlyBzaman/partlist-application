generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model bahan {
  id                BigInt    @id @default(autoincrement())
  code_lama         String?   @db.VarChar(100)
  code_baru         String?   @db.VarChar(100)
  nama_bahan        String    @db.VarChar(255)
  spesifikasi_bahan String?
  ukuran_unit       String?   @db.VarChar(100)
  stok_awal         String?   @db.VarChar(50)
  nama_loket        String?   @db.VarChar(255)
  keterangan1       String?
  keterangan2       String?
  keterangan3       String?
  keterangan4       String?
  keterangan5       String?
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
  created_by        String?
  currency          String?
  cost              Decimal?  @db.Decimal
  bea_material      String?
  supplier          String?

  // Relations
  produkBahans produkBahan[]

  @@index([code_baru], map: "idx_bahan_code_baru")
  @@index([code_lama], map: "idx_bahan_code_lama")
  @@index([nama_bahan], map: "idx_bahan_nama")
}

model bahan_input_sementara {
  id                BigInt    @id @default(autoincrement())
  session_id        String?   @db.VarChar(255)
  code_lama         String?   @db.VarChar(255)
  nama_bahan        String?   @db.VarChar(255)
  spesifikasi_bahan String?
  ukuran_unit       String?   @db.VarChar(100)
  stok_awal         String?   @db.VarChar(100)
  nama_loket        String?   @db.VarChar(255)
  keterangan1       String?
  keterangan2       String?
  keterangan3       String?
  keterangan4       String?
  keterangan5       String?
  created_by        String?   @db.VarChar(255)
  created_at        DateTime? @default(now()) @db.Timestamp(6)
  updated_at        DateTime? @default(now()) @db.Timestamp(6)
}

model users {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  username   String    @unique
  password   String
  role       String    @default("admin")
  created_at DateTime? @default(now()) @db.Timestamp(6)
}

model produk {
  id         BigInt    @id @default(autoincrement())
  namaproduk String    @db.VarChar(255)
  rated      String?   @db.VarChar(100)
  produk1    String?
  produk2    String?
  produk3    String?
  stokproduk String?   @db.VarChar(50)
  createdby  String?   @db.VarChar(100)
  createdat  DateTime? @default(now()) @db.Timestamp(6)
  updatedat  DateTime? @default(now()) @db.Timestamp(6)

  // Relations
  produkSnr18Kais produkSnr18Kai[]
  produkBahans    produkBahan[]

  @@index([namaproduk], map: "idx_produk_nama")
}

model produkBahan {
  id       BigInt   @id @default(autoincrement())
  produkId BigInt
  bahanId  BigInt
  quantity Decimal? @db.Decimal(12, 4)
  createdAt DateTime @default(now())

  // Relations
  produk produk @relation(fields: [produkId], references: [id], onDelete: Cascade)
  bahan bahan @relation(fields: [bahanId], references: [id], onDelete: Cascade)

  @@unique([produkId, bahanId])
  @@index([produkId])
  @@index([bahanId])
}

model produkSnr18Kai {
  id         BigInt   @id @default(autoincrement())
  produkId   BigInt
  snr18KaiId BigInt
  quantity   Decimal? @db.Decimal(12, 4)
  createdAt  DateTime @default(now())

  // Relations
  produk   produk   @relation(fields: [produkId], references: [id], onDelete: Cascade)
  snr18Kai SNR18_KAI @relation(fields: [snr18KaiId], references: [id], onDelete: Cascade)

  @@unique([produkId, snr18KaiId])
  @@index([produkId])
  @@index([snr18KaiId])
}

model SNR18_KAI {
  id                 BigInt   @id @default(autoincrement())
  
  code               String   @db.VarChar(50)
  namaBahan          String   @db.VarChar(255)
  spesifikasi        String?  @db.Text
  keterangan         String?  @db.Text

  pakaiPerPc         Decimal? @db.Decimal(12, 4)
  unit               String   @db.VarChar(20)

  hargaIdr           Decimal? @db.Decimal(18, 2)
  hargaUsd           Decimal? @db.Decimal(18, 2)
  hargaJpy           Decimal? @db.Decimal(18, 2)

  beaMasukPersen     Decimal? @db.Decimal(5, 2)
  freight            Decimal? @db.Decimal(18, 2)
  totalUsd           Decimal? @db.Decimal(18, 2)

  pembelianTerakhir  DateTime?
  keteranganAkhir    String?  @db.Text

  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  // Relations
  produkSnr18Kais produkSnr18Kai[]

  @@index([code])
  @@map("snr18_kai")
}
